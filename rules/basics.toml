# Basics Gate - Safe read-only shell commands
#
# This gate handles simple commands that are always safe to run:
# - Display/output commands (echo, cat, less, etc.)
# - File listing/finding (ls, find, fd, etc.)
# - Text processing (grep, awk, cut, etc.)
# - System info (ps, uname, etc.)
#
# Special handling:
# - sed: safe without -i flag
# - perl: safe without -i flag
# - xargs: safe only with known-safe target commands

# Simple list of always-safe commands
safe_commands = [
    # Display/output
    "echo",
    "printf",
    "cat",
    "head",
    "tail",
    "less",
    "more",
    "bat",
    "batcat",

    # Listing/finding
    "ls",
    "eza",
    "lsd",
    "tree",
    "find",
    "fd",
    "locate",
    "which",
    "whereis",
    "type",

    # Text processing (read-only)
    "grep",
    "rg",
    "ripgrep",
    "cut",
    "sort",
    "uniq",
    "wc",
    "tr",
    "column",
    "paste",
    "join",
    "comm",
    "diff",
    "cmp",
    "fold",
    "fmt",
    "nl",
    "rev",
    "tac",
    "expand",
    "unexpand",
    "pr",

    # File info
    "file",
    "stat",
    "du",
    "df",
    "lsof",
    "readlink",
    "realpath",
    "basename",
    "dirname",
    "lsattr",
    "getfacl",

    # Process/system info
    "ps",
    "top",
    "htop",
    "btop",
    "procs",
    "pgrep",
    "pidof",
    "uptime",
    "w",
    "who",
    "whoami",
    "id",
    "groups",
    "uname",
    "hostname",
    "hostnamectl",
    "date",
    "cal",
    "free",
    "vmstat",
    "iostat",
    "nproc",
    "lscpu",
    "lsmem",
    "lsblk",
    "lspci",
    "lsusb",
    "locale",
    "getconf",

    # GPU/graphics info (read-only only)
    "vainfo",
    "vdpauinfo",
    "glxinfo",
    "clinfo",

    # Display info (read-only only)
    "xdpyinfo",
    "xwininfo",


    # Network info (read-only)
    "ping",
    "traceroute",
    "tracepath",
    "mtr",
    "dig",
    "nslookup",
    "host",
    "whois",
    "ss",
    "netstat",
    "ip",
    "ifconfig",
    "route",
    "arp",

    # Archive listing (not extraction)
    "zipinfo",
    "unrar",

    # Dev tools (read-only)
    "tokei",
    "cloc",
    "scc",
    "loc",
    "jq",
    "yq",
    "gron",
    "fx",
    "hexdump",
    "xxd",
    "base64",
    "od",
    "hexyl",
    "strings",
    "delta",
    "difft",
    "dust",
    "fselect",
    "pastel",
    "numbat",
    "fzf",
    "tig",
    "z",
    "zi",
    "zoxide",
    "sha256sum",
    "md5sum",
    "sha1sum",
    "sha512sum",
    "b2sum",
    "cksum",

    # Help/docs
    "man",
    "info",
    "help",
    "tldr",
    "tealdeer",
    "cheat",

    # Misc safe
    "true",
    "false",
    "yes",
    "seq",
    "expr",
    "bc",
    "dc",
    "factor",
    "sleep",
    "wait",
    "printenv",
    "export",
    "set",
    "pwd",
    "cd",
    "pushd",
    "popd",
    "dirs",
    "unalias",
    "hash",
    "test",
    "[",
    "[[",
]

[meta]
name = "basics"
description = "Safe read-only shell commands"
priority = 100

# xargs needs custom handling to check target command
[[custom_handlers]]
program = "xargs"
handler = "check_xargs"
description = "Allow xargs only when target command is in safe_commands list"
